<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Fluid-JS Build - Test (createSplat API)</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { overflow: hidden; background: black; font-family: 'Courier New', monospace; }

        #info {
            position: fixed; top: 10px; left: 10px;
            background: rgba(0,0,0,0.95); color: #0ff;
            padding: 20px; border-radius: 10px; font-size: 12px;
            z-index: 1000; max-width: 500px; border: 2px solid #0ff;
            max-height: 90vh; overflow-y: auto;
        }

        #info h3 {
            margin: 0 0 15px 0; color: #0f0; font-size: 16px;
            border-bottom: 1px solid #0ff; padding-bottom: 8px;
        }

        .param {
            margin: 5px 0; padding: 5px;
            background: rgba(0, 255, 255, 0.1);
        }

        .param strong { color: #ff0; }

        .log-entry {
            margin: 3px 0; padding: 3px;
            font-size: 11px; line-height: 1.4;
        }

        .log-success { color: #0f0; }
        .log-warning { color: #ff0; }
        .log-error { color: #f00; }
    </style>
</head>
<body>
    <div id="info">
        <h3>üß™ Custom Fluid-JS Build Test (PARAMETERIZED)</h3>
        <div class="param"><strong>Build:</strong> dist/fluid-js-custom-final.min.js (41.1 KB)</div>
        <div class="param"><strong>Multi Color:</strong> false (defaults.js)</div>
        <div class="param"><strong>Init Splat:</strong> NINCS (initializer.js)</div>
        <div class="param"><strong>API:</strong> createSplat() (fluid.js)</div>
        <div class="param"><strong>Config:</strong> ANIMATION_CONFIG objektum (script elej√©n)</div>
        <div class="param"><strong>H√°tt√©r:</strong> Fekete (r:0, g:0, b:0)</div>
        <div class="param"><strong>Fizika:</strong> sim_res=512, dissipation=1, velocity=0.999, curl=10, emitter_size=2.0</div>

        <div class="param" style="margin-top: 10px; border-top: 1px solid #0ff; padding-top: 10px;">
            <strong>Testreszab√°si pontok (ANIMATION_CONFIG):</strong><br>
            ‚Ä¢ timing: scriptLoadDelay, fluidInitDelay, splatCreationDelay<br>
            ‚Ä¢ canvas: zIndex, pointerEvents, position<br>
            ‚Ä¢ fluidBehavior: √ñSSZES fizikai param√©ter (sim_resolution, dissipation, velocity, pressure, curl, emitter_size, bloom, stb.)<br>
            ‚Ä¢ animation: velocityMultiplier (sebess√©g szab√°lyoz√°s)<br>
            ‚Ä¢ colors: RGB sz√≠npaletta (21 sz√≠n - alap, hideg, meleg, z√∂ld, pastel)<br>
            ‚Ä¢ initialSplats: x, y, dx, dy, radius, delay, colorIndex
        </div>

        <div class="param" style="margin-top: 10px; border-top: 1px solid #ff0; padding-top: 10px; background: rgba(255,255,0,0.1);">
            <strong>üíæ Preset Manager (Console API):</strong><br>
            <em style="color: #0ff;">LocalStorage preset-ek:</em><br>
            ‚Ä¢ PresetManager.save("n√©v") - Aktu√°lis konfig ment√©se<br>
            ‚Ä¢ <strong>PresetManager.apply("n√©v")</strong> - Preset bet√∂lt√©se √âS alkalmaz√°sa<br>
            ‚Ä¢ PresetManager.list() - √ñsszes preset list√°z√°sa<br>
            ‚Ä¢ PresetManager.delete("n√©v") - Preset t√∂rl√©se<br>
            <br>
            <em style="color: #0f0;">üíæ F√°jl alap√∫ (AJ√ÅNLOTT):</em><br>
            ‚Ä¢ <strong>PresetManager.exportToFile()</strong> - JSON f√°jl let√∂lt√©se<br>
            ‚Ä¢ <strong>PresetManager.importFromFile()</strong> - JSON f√°jl felt√∂lt√©se<br>
            <br>
            <em style="color: #888;">String alap√∫ (fallback):</em><br>
            ‚Ä¢ PresetManager.export() - JSON console-ba<br>
            ‚Ä¢ PresetManager.import(json) - JSON string-b≈ël
        </div>

        <h3 style="margin-top: 15px;">Console Log:</h3>
        <div id="logs"></div>
    </div>

    <script>
        // ============================================
        // LOGGING
        // ============================================

        function log(msg, type = 'info') {
            const logsDiv = document.getElementById('logs');
            const div = document.createElement('div');
            div.className = 'log-entry log-' + type;
            div.textContent = msg;
            logsDiv.appendChild(div);
            logsDiv.scrollTop = logsDiv.scrollHeight;
            console.log(msg);
        }

        log('üöÄ Script bet√∂ltve', 'success');
    </script>

    <!-- FONTOS: Custom Fluid-JS Build (FINAL verzi√≥) -->
    <!-- Tartalmazza: defaults.js m√≥dos√≠t√°sok + createSplat() API + nincs init splat -->

    <script src="dist/fluid-js-custom-final.min.js"></script>

    <script>
        // ============================================
        // KONFIGUR√ÅCI√ìS OBJEKTUM - ANIM√ÅCI√ìS PARAM√âTEREK
        // ============================================

        const ANIMATION_CONFIG = {
            // Id≈ëz√≠t√©sek (milliszekundum)
            timing: {
                scriptLoadDelay: 500,        // Fluid library bet√∂lt√©se ut√°n v√°rakoz√°s
                fluidInitDelay: 500,         // Fluid activate() ut√°n v√°rakoz√°s
                splatCreationDelay: 500,     // createSplat() el√©rhet≈ës√©g el≈ëtti v√°rakoz√°s
            },

            // Canvas be√°ll√≠t√°sok
            canvas: {
                zIndex: -1,
                pointerEvents: 'none',
                position: 'fixed'
            },

            // Fluid Behavior param√©terek - TELJES FIZIKAI KONFIGUR√ÅCI√ì
            // Ezek OVERRIDE-olj√°k a defaults.js √©rt√©keit a mapBehaviors() h√≠v√°son kereszt√ºl
            fluidBehavior: {
                // Felbont√°s (GPU texture quality)
                sim_resolution: 256,        // 32-512 (magasabb = jobb min≈ës√©g, lassabb)
                dye_resolution: 512,        // 128-2048 (sz√≠n felbont√°s)

                // Dissipation (halv√°nyod√°s, lassul√°s)
                dissipation: 1.000,             // 0.9-1.0 (1 = nincs halv√°nyod√°s)
                velocity: 0.999,            // 0.9-1.0 (mozg√°s lassul√°sa)

                // Pressure (nyom√°s szimul√°ci√≥)
                pressure: 0.6,              // 0.0-1.0
                pressure_iteration: 20,     // 10-50 (iter√°ci√≥k sz√°ma)

                // Curl (√∂rv√©nyl√©s er≈ëss√©ge)
                curl: 5,                   // 0-50 (magasabb = t√∂bb √∂rv√©ny)

                // Splat tulajdons√°gok
                emitter_size: 1.0,          // 0.1-3.0 (splat alapm√©ret) NEM HASZN√ÅLT!

                // Vizu√°lis be√°ll√≠t√°sok
                render_shaders: true,       // true/false (shader renderel√©s)
                multi_color: false,         // true/false (random sz√≠nek)
                render_bloom: false,        // true/false (f√©ny effekt)

                // Bloom param√©terek (ha render_bloom: true)
                bloom_iterations: 8,
                bloom_resolution: 256,
                intensity: 0.8,
                threshold: 0.6,
                soft_knee: 0.7,

                // H√°tt√©r
                background_color: { r: 0, g: 0, b: 0 },  // Fekete h√°tt√©r
                transparent: false          // true/false (√°tl√°tsz√≥ h√°tt√©r)
            },

            // Anim√°ci√≥ sebess√©g szab√°lyoz√°s
            animation: {
                velocityMultiplier: 1.0     // Glob√°lis sebess√©g szorz√≥ (0.1 = lass√∫, 2.0 = gyors)
            },

            // Sz√≠npaletta
            // FONTOS: A fluid szimul√°ci√≥ addit√≠v (hozz√°ad√≥) sz√≠nkever√©st haszn√°l!
            // Ez azt jelenti, hogy r:0, g:0, b:0 (tiszta fekete) hozz√°adva b√°rmihez
            // nem v√°ltoztat semmit (0 + valami = valami).
            // Ez√©rt "fekete" helyett nagyon s√∂t√©t sz√ºrke (5, 5, 5) aj√°nlott.
            colors: [
                // Alap sz√≠nek
                { r: 5, g: 5, b: 5 },         // 0: Nagyon s√∂t√©t sz√ºrke (pszeudo-fekete)
                { r: 255, g: 255, b: 255 },   // 1: Feh√©r

                // Hideg sz√≠nek (t√ºrkiz, k√©k, lila √°rnyalatok)
                { r: 0, g: 255, b: 255 },     // 2: T√ºrkiz (cyan)
                { r: 0, g: 200, b: 255 },     // 3: √âgsz√≠nk√©k
                { r: 0, g: 128, b: 255 },     // 4: Kir√°lyk√©k
                { r: 100, g: 150, b: 255 },   // 5: L√°gy k√©k
                { r: 204, g: 51, b: 255 },    // 6: √âl√©nk lila
                { r: 180, g: 100, b: 255 },   // 7: Levendula
                { r: 255, g: 0, b: 255 },     // 8: Magenta

                // Meleg sz√≠nek (pink, korall, narancs, arany √°rnyalatok)
                { r: 255, g: 105, b: 180 },   // 9: R√≥zsasz√≠n (hot pink)
                { r: 255, g: 150, b: 200 },   // 10: L√°gy pink
                { r: 255, g: 127, b: 80 },    // 11: Korall
                { r: 255, g: 165, b: 0 },     // 12: Narancs
                { r: 255, g: 215, b: 0 },     // 13: Arany
                { r: 255, g: 255, b: 100 },   // 14: Citroms√°rga

                // Z√∂ld √°rnyalatok
                { r: 0, g: 255, b: 150 },     // 15: Mentaz√∂ld
                { r: 50, g: 255, b: 100 },    // 16: Smaragdz√∂ld
                { r: 150, g: 255, b: 150 },   // 17: L√°gy z√∂ld

                // Pastel √°rnyalatok (fluid art kedvencek)
                { r: 200, g: 230, b: 255 },   // 18: Pasztell k√©k
                { r: 255, g: 200, b: 230 },   // 19: Pasztell pink
                { r: 230, g: 200, b: 255 }    // 20: Pasztell lila
            ],

            // Kezdeti splat-ok konfigur√°ci√≥ja
            initialSplats: [
                {
                    colorIndex: 6,           // √âl√©nk lila
                    x: 0.5, y: 0.5,
                    dx: 70, dy: 10,
                    radius: 5.5,
                    delay: 0
                },
                {
                    colorIndex: 2,           // T√ºrkiz
                    x: 0.3, y: 0.5,
                    dx: 50, dy: -20,
                    radius: 5.5,
                    delay: 1200
                },
                {
                    colorIndex: 6,           // √âl√©nk lila
                    x: 0.1, y: 0.3,
                    dx: 200, dy: -100,
                    radius: 6.0,
                    delay: 2800
                },
                {
                    colorIndex: 13,           // T√ºrkiz
                    x: 0.1, y: 0.3,
                    dx: 300, dy: 50,
                    radius: 6.0,
                    delay: 5000
                }
            ]
        };

        // Backward compatibility: FLUID_COLORS √©s INITIAL_SPLATS gener√°l√°sa config-b√≥l
        const FLUID_COLORS = ANIMATION_CONFIG.colors;
        const INITIAL_SPLATS = ANIMATION_CONFIG.initialSplats.map(function(splat) {
            return {
                color: ANIMATION_CONFIG.colors[splat.colorIndex],
                x: splat.x,
                y: splat.y,
                dx: splat.dx * ANIMATION_CONFIG.animation.velocityMultiplier,
                dy: splat.dy * ANIMATION_CONFIG.animation.velocityMultiplier,
                radius: splat.radius,
                delay: splat.delay
            };
        });

        // ============================================
        // CANVAS L√âTREHOZ√ÅSA
        // ============================================

        log('Canvas l√©trehoz√°sa...');
        const canvas = document.createElement('canvas');
        canvas.id = 'fluidArtCanvas';
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        canvas.style.cssText = 'display:block;width:100vw;height:100vh;' +
            'position:' + ANIMATION_CONFIG.canvas.position + ';' +
            'top:0;left:0;' +
            'z-index:' + ANIMATION_CONFIG.canvas.zIndex + ';' +
            'pointer-events:' + ANIMATION_CONFIG.canvas.pointerEvents;
        document.body.insertBefore(canvas, document.body.firstChild);
        log('‚úÖ Canvas OK', 'success');

        // ============================================
        // FLUID INICIALIZ√ÅL√ÅS
        // ============================================

        setTimeout(function() {
            if (typeof Fluid === 'undefined') {
                log('‚ùå Fluid library NINCS!', 'error');
                return;
            }

            log('Fluid p√©ld√°ny l√©trehoz√°sa...', 'warning');
            const myFluid = new Fluid(canvas);
            log('‚úÖ Fluid p√©ld√°ny OK', 'success');

            // Explicit override (config alapj√°n)
            myFluid.mapBehaviors(ANIMATION_CONFIG.fluidBehavior);

            log('Fluid aktiv√°l√°sa...', 'warning');
            myFluid.activate();
            log('‚úÖ Fluid aktiv√°lva', 'success');

            // V√ÅRUNK, hogy a fluid teljesen inicializ√°l√≥djon (config timing)
            setTimeout(function() {
                log('üé® Splat-ok gener√°l√°sa (createSplat API)...', 'warning');

                // ELLEN≈êRZ√âS: createSplat() met√≥dus el√©rhet≈ë?
                if (typeof myFluid.createSplat !== 'function') {
                    log('‚ùå HIBA: createSplat() met√≥dus NEM el√©rhet≈ë!', 'error');
                    log('Ez azt jelenti, hogy a custom build NEM m≈±k√∂d√∂tt.', 'error');
                    return;
                } else {
                    log('‚úÖ createSplat() met√≥dus el√©rhet≈ë', 'success');
                }

                // SPLAT-OK GENER√ÅL√ÅSA √öJ API-VAL
                INITIAL_SPLATS.forEach(function(splatConfig, index) {
                    setTimeout(function() {
                        try {
                            myFluid.createSplat({
                                color: splatConfig.color,
                                x: splatConfig.x,
                                y: splatConfig.y,
                                dx: splatConfig.dx,
                                dy: splatConfig.dy,
                                radius: splatConfig.radius
                            });

                            const colorNames = ['t√ºrkiz', 'lila', 'kir√°lyk√©k'];
                            log('üé® Splat #' + (index + 1) + ' - ' + colorNames[index] +
                                ' (r=' + splatConfig.color.r + ',g=' + splatConfig.color.g + ',b=' + splatConfig.color.b + ')', 'success');
                        } catch (error) {
                            log('‚ùå HIBA splat l√©trehoz√°skor: ' + error.message, 'error');
                        }
                    }, splatConfig.delay);
                });

                log('‚úÖ √ñsszes splat √ºtemezve', 'success');
            }, ANIMATION_CONFIG.timing.splatCreationDelay);
        }, ANIMATION_CONFIG.timing.scriptLoadDelay);

        // ============================================
        // PRESET KEZEL≈ê RENDSZER (LocalStorage)
        // ============================================

        const PresetManager = {
            // Preset ment√©se
            save: function(name) {
                try {
                    const preset = {
                        name: name,
                        timestamp: new Date().toISOString(),
                        config: ANIMATION_CONFIG  // CSAK az ANIMATION_CONFIG objektum (clean)
                    };
                    localStorage.setItem('fluidArtPreset_' + name, JSON.stringify(preset));
                    log('üíæ Preset mentve: ' + name, 'success');
                    return true;
                } catch (error) {
                    log('‚ùå Preset ment√©si hiba: ' + error.message, 'error');
                    return false;
                }
            },

            // Preset bet√∂lt√©se
            load: function(name) {
                try {
                    const presetData = localStorage.getItem('fluidArtPreset_' + name);
                    if (!presetData) {
                        log('‚ùå Preset nem tal√°lhat√≥: ' + name, 'error');
                        return null;
                    }
                    const preset = JSON.parse(presetData);
                    log('üìÇ Preset bet√∂ltve: ' + name + ' (mentve: ' + preset.timestamp + ')', 'success');

                    // Bet√∂lt√∂tt konfigur√°ci√≥ ki√≠r√°sa (csak a f≈ëbb r√©szek)
                    console.log('üîç Bet√∂lt√∂tt konfigur√°ci√≥:', preset.config);
                    console.log('  ‚Ä¢ timing:', preset.config.timing);
                    console.log('  ‚Ä¢ fluidBehavior:', preset.config.fluidBehavior);
                    console.log('  ‚Ä¢ animation:', preset.config.animation);
                    console.log('  ‚Ä¢ initialSplats (db):', preset.config.initialSplats.length);

                    return preset.config;
                } catch (error) {
                    log('‚ùå Preset bet√∂lt√©si hiba: ' + error.message, 'error');
                    return null;
                }
            },

            // √ñsszes preset list√°z√°sa
            list: function() {
                const presets = [];
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key.startsWith('fluidArtPreset_')) {
                        const name = key.replace('fluidArtPreset_', '');
                        presets.push(name);
                    }
                }
                return presets;
            },

            // Preset t√∂rl√©se
            delete: function(name) {
                try {
                    localStorage.removeItem('fluidArtPreset_' + name);
                    log('üóëÔ∏è Preset t√∂r√∂lve: ' + name, 'warning');
                    return true;
                } catch (error) {
                    log('‚ùå Preset t√∂rl√©si hiba: ' + error.message, 'error');
                    return false;
                }
            },

            // Aktu√°lis konfigur√°ci√≥ export√°l√°sa JSON-k√©nt (console-ba)
            export: function() {
                // JSON.stringify automatikusan kihagyja a f√ºggv√©nyeket √©s csak az adatokat tartalmazza
                const jsonString = JSON.stringify(ANIMATION_CONFIG, null, 2);

                // Console-ba OLVASHAT√ì form√°ban ki√≠r√°s (nem %c, hanem tiszta JSON objektum)
                console.log('üì§ EXPORT√ÅLT KONFIGUR√ÅCI√ì (m√°sold ki a console-b√≥l):');
                console.log('');
                console.log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
                // Objektum form√°ban (collapse-olhat√≥, m√°solhat√≥)
                console.log(ANIMATION_CONFIG);
                console.log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
                console.log('');
                console.log('üìã JSON STRING (m√°sold ki Ctrl+C):');
                // String form√°ban is ki√≠rjuk tiszt√°n (m√°solhat√≥)
                console.log(jsonString);
                console.log('');

                log('üì§ Export k√©sz! Nyisd ki a console-t, kattints a JSON objektumra jobb gombbal ‚Üí Copy object, vagy m√°sold ki a JSON string-et!', 'success');
                log('üí° AJ√ÅNLOTT: Haszn√°ld a exportToFile() f√ºggv√©nyt f√°jl let√∂lt√©shez!', 'warning');

                return jsonString;
            },

            // Konfigur√°ci√≥ export√°l√°sa F√ÅJLBA (let√∂lt√©s)
            exportToFile: function(filename) {
                try {
                    if (!filename) {
                        filename = 'fluid-art-config-' + new Date().toISOString().replace(/:/g, '-').split('.')[0] + '.json';
                    }

                    const jsonString = JSON.stringify(ANIMATION_CONFIG, null, 2);

                    // Blob l√©trehoz√°sa (f√°jl tartalom)
                    const blob = new Blob([jsonString], { type: 'application/json' });

                    // Let√∂lt√©si link l√©trehoz√°sa
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = filename;
                    document.body.appendChild(a);
                    a.click();

                    // Cleanup
                    setTimeout(function() {
                        document.body.removeChild(a);
                        URL.revokeObjectURL(url);
                    }, 100);

                    log('üíæ Konfigur√°ci√≥ f√°jlba export√°lva: ' + filename, 'success');
                    console.log('üìÇ F√°jl n√©v:', filename);
                    console.log('üìè F√°jl m√©ret:', (jsonString.length / 1024).toFixed(2), 'KB');

                    return true;
                } catch (error) {
                    log('‚ùå F√°jl export hiba: ' + error.message, 'error');
                    console.error('Stack trace:', error);
                    return false;
                }
            },

            // Konfigur√°ci√≥ import√°l√°sa JSON string-b≈ël (√âS ALKALMAZ√ÅSA!)
            import: function(jsonString) {
                try {
                    console.log('üì• Import ind√≠t√°sa (string alap√∫)...');
                    console.log('üìã Be√©rkezett JSON hossza:', jsonString.length, 'karakter');

                    const config = JSON.parse(jsonString);

                    console.log('‚úÖ JSON parsing sikeres');
                    console.log('üìã Import√°lt konfigur√°ci√≥:', config);

                    // Jelenlegi konfigur√°ci√≥ ment√©se √∂sszehasonl√≠t√°shoz
                    const oldConfig = {
                        timing: JSON.parse(JSON.stringify(ANIMATION_CONFIG.timing)),
                        fluidBehavior: JSON.parse(JSON.stringify(ANIMATION_CONFIG.fluidBehavior)),
                        animation: JSON.parse(JSON.stringify(ANIMATION_CONFIG.animation)),
                        initialSplatsCount: ANIMATION_CONFIG.initialSplats.length
                    };

                    console.log('üìã Jelenlegi konfigur√°ci√≥ (import el≈ëtt):', oldConfig);

                    // DEEP MERGE - Minden nested property friss√≠t√©se (ugyanaz, mint apply())
                    // TIMING
                    if (config.timing) {
                        Object.assign(ANIMATION_CONFIG.timing, config.timing);
                    }

                    // CANVAS
                    if (config.canvas) {
                        Object.assign(ANIMATION_CONFIG.canvas, config.canvas);
                    }

                    // FLUID BEHAVIOR (LEGFONTOSABB!)
                    if (config.fluidBehavior) {
                        Object.assign(ANIMATION_CONFIG.fluidBehavior, config.fluidBehavior);
                    }

                    // ANIMATION
                    if (config.animation) {
                        Object.assign(ANIMATION_CONFIG.animation, config.animation);
                    }

                    // COLORS (teljes csere, mert array)
                    if (config.colors) {
                        ANIMATION_CONFIG.colors = config.colors;
                    }

                    // INITIAL SPLATS (teljes csere, mert array)
                    if (config.initialSplats) {
                        ANIMATION_CONFIG.initialSplats = config.initialSplats;
                    }

                    console.log('‚úÖ ANIMATION_CONFIG friss√≠tve import√°lt adatokkal');
                    console.log('üìã √öj konfigur√°ci√≥ (import ut√°n):', {
                        timing: ANIMATION_CONFIG.timing,
                        fluidBehavior: ANIMATION_CONFIG.fluidBehavior,
                        animation: ANIMATION_CONFIG.animation,
                        initialSplatsCount: ANIMATION_CONFIG.initialSplats.length
                    });

                    // √ñSSZEHASONL√çT√ÅS
                    console.log('üîÄ V√ÅLTOZ√ÅSOK:');
                    console.log('  timing:', JSON.stringify(oldConfig.timing) !== JSON.stringify(ANIMATION_CONFIG.timing) ? 'V√ÅLTOZOTT ‚úì' : 'v√°ltozatlan');
                    console.log('  fluidBehavior:', JSON.stringify(oldConfig.fluidBehavior) !== JSON.stringify(ANIMATION_CONFIG.fluidBehavior) ? 'V√ÅLTOZOTT ‚úì' : 'v√°ltozatlan');
                    console.log('  animation:', JSON.stringify(oldConfig.animation) !== JSON.stringify(ANIMATION_CONFIG.animation) ? 'V√ÅLTOZOTT ‚úì' : 'v√°ltozatlan');
                    console.log('  initialSplats:', oldConfig.initialSplatsCount !== ANIMATION_CONFIG.initialSplats.length ? 'V√ÅLTOZOTT ‚úì (' + oldConfig.initialSplatsCount + ' ‚Üí ' + ANIMATION_CONFIG.initialSplats.length + ')' : 'v√°ltozatlan');

                    log('üì• Konfigur√°ci√≥ import√°lva √©s alkalmazva! (oldal √∫jrat√∂lt√©s aj√°nlott a teljes hat√°s√©rt)', 'success');
                    return true;
                } catch (error) {
                    log('‚ùå Import hiba: ' + error.message, 'error');
                    console.error('Stack trace:', error);
                    console.log('üí° Ellen≈ërizd, hogy helyes JSON form√°tumot m√°solt√°l be!');
                    console.log('üí° AJ√ÅNLOTT: Haszn√°ld a importFromFile() f√ºggv√©nyt f√°jl felt√∂lt√©shez!');
                    return false;
                }
            },

            // Konfigur√°ci√≥ import√°l√°sa F√ÅJLB√ìL (felt√∂lt√©s)
            importFromFile: function() {
                // File input elem l√©trehoz√°sa (rejtett)
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'application/json,.json';
                input.style.display = 'none';
                document.body.appendChild(input);

                // File select event handler
                input.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (!file) {
                        log('‚ùå Nincs kiv√°lasztott f√°jl', 'error');
                        document.body.removeChild(input);
                        return;
                    }

                    console.log('üìÇ F√°jl kiv√°lasztva:', file.name);
                    console.log('üìè F√°jl m√©ret:', (file.size / 1024).toFixed(2), 'KB');

                    // FileReader haszn√°lata f√°jl tartalom olvas√°s√°hoz
                    const reader = new FileReader();

                    reader.onload = function(event) {
                        try {
                            const jsonString = event.target.result;

                            console.log('üì• F√°jl beolvasva, JSON parsing...');
                            const config = JSON.parse(jsonString);

                            console.log('‚úÖ JSON parsing sikeres');
                            console.log('üìã Import√°lt konfigur√°ci√≥:', config);

                            // Jelenlegi konfigur√°ci√≥ ment√©se √∂sszehasonl√≠t√°shoz
                            const oldConfig = {
                                timing: JSON.parse(JSON.stringify(ANIMATION_CONFIG.timing)),
                                fluidBehavior: JSON.parse(JSON.stringify(ANIMATION_CONFIG.fluidBehavior)),
                                animation: JSON.parse(JSON.stringify(ANIMATION_CONFIG.animation)),
                                initialSplatsCount: ANIMATION_CONFIG.initialSplats.length
                            };

                            console.log('üìã Jelenlegi konfigur√°ci√≥ (import el≈ëtt):', oldConfig);

                            // DEEP MERGE - Minden nested property friss√≠t√©se
                            // TIMING
                            if (config.timing) {
                                Object.assign(ANIMATION_CONFIG.timing, config.timing);
                            }

                            // CANVAS
                            if (config.canvas) {
                                Object.assign(ANIMATION_CONFIG.canvas, config.canvas);
                            }

                            // FLUID BEHAVIOR (LEGFONTOSABB!)
                            if (config.fluidBehavior) {
                                Object.assign(ANIMATION_CONFIG.fluidBehavior, config.fluidBehavior);
                            }

                            // ANIMATION
                            if (config.animation) {
                                Object.assign(ANIMATION_CONFIG.animation, config.animation);
                            }

                            // COLORS (teljes csere, mert array)
                            if (config.colors) {
                                ANIMATION_CONFIG.colors = config.colors;
                            }

                            // INITIAL SPLATS (teljes csere, mert array)
                            if (config.initialSplats) {
                                ANIMATION_CONFIG.initialSplats = config.initialSplats;
                            }

                            console.log('‚úÖ ANIMATION_CONFIG friss√≠tve f√°jlb√≥l import√°lt adatokkal');
                            console.log('üìã √öj konfigur√°ci√≥ (import ut√°n):', {
                                timing: ANIMATION_CONFIG.timing,
                                fluidBehavior: ANIMATION_CONFIG.fluidBehavior,
                                animation: ANIMATION_CONFIG.animation,
                                initialSplatsCount: ANIMATION_CONFIG.initialSplats.length
                            });

                            // √ñSSZEHASONL√çT√ÅS
                            console.log('üîÄ V√ÅLTOZ√ÅSOK:');
                            console.log('  timing:', JSON.stringify(oldConfig.timing) !== JSON.stringify(ANIMATION_CONFIG.timing) ? 'V√ÅLTOZOTT ‚úì' : 'v√°ltozatlan');
                            console.log('  fluidBehavior:', JSON.stringify(oldConfig.fluidBehavior) !== JSON.stringify(ANIMATION_CONFIG.fluidBehavior) ? 'V√ÅLTOZOTT ‚úì' : 'v√°ltozatlan');
                            console.log('  animation:', JSON.stringify(oldConfig.animation) !== JSON.stringify(ANIMATION_CONFIG.animation) ? 'V√ÅLTOZOTT ‚úì' : 'v√°ltozatlan');
                            console.log('  initialSplats:', oldConfig.initialSplatsCount !== ANIMATION_CONFIG.initialSplats.length ? 'V√ÅLTOZOTT ‚úì (' + oldConfig.initialSplatsCount + ' ‚Üí ' + ANIMATION_CONFIG.initialSplats.length + ')' : 'v√°ltozatlan');

                            log('üì• Konfigur√°ci√≥ f√°jlb√≥l import√°lva √©s alkalmazva! (' + file.name + ')', 'success');
                            log('‚ö†Ô∏è Oldal √∫jrat√∂lt√©s aj√°nlott a teljes hat√°s√©rt (F5)', 'warning');

                            // Cleanup
                            document.body.removeChild(input);
                        } catch (error) {
                            log('‚ùå F√°jl import hiba: ' + error.message, 'error');
                            console.error('Stack trace:', error);
                            console.log('üí° Ellen≈ërizd, hogy a f√°jl helyes JSON form√°tumot tartalmaz!');
                            document.body.removeChild(input);
                        }
                    };

                    reader.onerror = function() {
                        log('‚ùå F√°jl olvas√°si hiba', 'error');
                        document.body.removeChild(input);
                    };

                    // F√°jl tartalom olvas√°sa text-k√©nt
                    reader.readAsText(file);
                });

                // File picker megnyit√°sa
                input.click();
                log('üìÇ F√°jl v√°laszt√≥ megnyitva... V√°lassz egy .json f√°jlt!', 'warning');
            },

            // Bet√∂lt√∂tt preset alkalmaz√°sa (√âRV√âNYRE JUTTAT√ÅS)
            apply: function(name) {
                try {
                    console.log('üîÑ Apply() megh√≠vva:', name);

                    // Jelenlegi konfigur√°ci√≥ ment√©se √∂sszehasonl√≠t√°shoz
                    const oldConfig = {
                        timing: JSON.parse(JSON.stringify(ANIMATION_CONFIG.timing)),
                        fluidBehavior: JSON.parse(JSON.stringify(ANIMATION_CONFIG.fluidBehavior)),
                        animation: JSON.parse(JSON.stringify(ANIMATION_CONFIG.animation)),
                        initialSplatsCount: ANIMATION_CONFIG.initialSplats.length
                    };

                    console.log('üìã Jelenlegi konfigur√°ci√≥ (apply el≈ëtt):', oldConfig);

                    const loadedConfig = this.load(name);
                    if (!loadedConfig) {
                        log('‚ùå Nem siker√ºlt bet√∂lteni a preset-et: ' + name, 'error');
                        return false;
                    }

                    // DEEP MERGE - Minden nested property friss√≠t√©se
                    // TIMING
                    Object.assign(ANIMATION_CONFIG.timing, loadedConfig.timing);

                    // CANVAS
                    Object.assign(ANIMATION_CONFIG.canvas, loadedConfig.canvas);

                    // FLUID BEHAVIOR (LEGFONTOSABB!)
                    Object.assign(ANIMATION_CONFIG.fluidBehavior, loadedConfig.fluidBehavior);

                    // ANIMATION
                    Object.assign(ANIMATION_CONFIG.animation, loadedConfig.animation);

                    // COLORS (teljes csere, mert array)
                    ANIMATION_CONFIG.colors = loadedConfig.colors;

                    // INITIAL SPLATS (teljes csere, mert array)
                    ANIMATION_CONFIG.initialSplats = loadedConfig.initialSplats;

                    console.log('‚úÖ ANIMATION_CONFIG friss√≠tve');
                    console.log('üìã √öj konfigur√°ci√≥ (apply ut√°n):', {
                        timing: ANIMATION_CONFIG.timing,
                        fluidBehavior: ANIMATION_CONFIG.fluidBehavior,
                        animation: ANIMATION_CONFIG.animation,
                        initialSplatsCount: ANIMATION_CONFIG.initialSplats.length
                    });

                    // √ñSSZEHASONL√çT√ÅS
                    console.log('üîÄ V√ÅLTOZ√ÅSOK:');
                    console.log('  timing:', JSON.stringify(oldConfig.timing) !== JSON.stringify(ANIMATION_CONFIG.timing) ? 'V√ÅLTOZOTT ‚úì' : 'v√°ltozatlan');
                    console.log('  fluidBehavior:', JSON.stringify(oldConfig.fluidBehavior) !== JSON.stringify(ANIMATION_CONFIG.fluidBehavior) ? 'V√ÅLTOZOTT ‚úì' : 'v√°ltozatlan');
                    console.log('  animation:', JSON.stringify(oldConfig.animation) !== JSON.stringify(ANIMATION_CONFIG.animation) ? 'V√ÅLTOZOTT ‚úì' : 'v√°ltozatlan');
                    console.log('  initialSplats:', oldConfig.initialSplatsCount !== ANIMATION_CONFIG.initialSplats.length ? 'V√ÅLTOZOTT ‚úì (' + oldConfig.initialSplatsCount + ' ‚Üí ' + ANIMATION_CONFIG.initialSplats.length + ')' : 'v√°ltozatlan');

                    log('‚ö° Preset alkalmazva: ' + name + ' (oldal √∫jrat√∂lt√©s aj√°nlott a teljes hat√°s√©rt)', 'warning');
                    return true;
                } catch (error) {
                    log('‚ùå Preset alkalmaz√°si hiba: ' + error.message, 'error');
                    console.error('Stack trace:', error);
                    return false;
                }
            }
        };

        // Glob√°lis scope-ba helyez√©s (console hozz√°f√©r√©shez)
        window.PresetManager = PresetManager;

        log('‚úÖ Preset Manager inicializ√°lva', 'success');
        log('üí° Haszn√°lat:', 'warning');
        log('  ‚Ä¢ PresetManager.save("preset_neve") - Jelenlegi konfigur√°ci√≥ ment√©se (localStorage)', 'info');
        log('  ‚Ä¢ PresetManager.apply("preset_neve") - Preset bet√∂lt√©se √âS alkalmaz√°sa', 'info');
        log('  ‚Ä¢ PresetManager.list() - Mentett preset-ek list√°z√°sa', 'info');
        log('  ‚Ä¢ PresetManager.delete("preset_neve") - Preset t√∂rl√©se', 'info');
        log('', 'info');
        log('  üíæ F√ÅJL ALAP√ö (AJ√ÅNLOTT):', 'warning');
        log('  ‚Ä¢ PresetManager.exportToFile() - JSON f√°jl let√∂lt√©se (automatikus f√°jln√©v)', 'info');
        log('  ‚Ä¢ PresetManager.exportToFile("custom.json") - JSON f√°jl let√∂lt√©se (egyedi f√°jln√©v)', 'info');
        log('  ‚Ä¢ PresetManager.importFromFile() - JSON f√°jl felt√∂lt√©se √©s alkalmaz√°sa', 'info');
        log('', 'info');
        log('  üìã STRING ALAP√ö (fallback):', 'warning');
        log('  ‚Ä¢ PresetManager.export() - Konfigur√°ci√≥ JSON export√°l√°sa (console-ba)', 'info');
        log('  ‚Ä¢ PresetManager.import(jsonString) - JSON string import√°l√°sa', 'info');

        // ============================================
        // RESIZE HANDLER
        // ============================================

        window.addEventListener('resize', function() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });

        log('‚úÖ Resize handler hozz√°adva', 'success');
    </script>
</body>
</html>
