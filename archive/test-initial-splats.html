<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fluid-JS Kezdeti Splat-ok Teszt</title>
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            padding: 0;
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #1a1a1a;
            overflow-x: hidden;
        }

        .debug-panel {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.85);
            color: #00ff00;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-width: 300px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
        }

        .debug-panel h3 {
            margin-top: 0;
            color: #00ffff;
            font-size: 14px;
        }

        .debug-item {
            margin: 8px 0;
            padding: 5px;
            background: rgba(0, 255, 255, 0.1);
            border-left: 3px solid #00ffff;
        }

        .debug-item.success {
            border-left-color: #00ff00;
        }

        .debug-item.error {
            border-left-color: #ff0000;
            color: #ff6666;
        }

        .test-content {
            position: relative;
            z-index: 10;
            background: rgba(255, 255, 255, 0.92);
            backdrop-filter: blur(10px);
            margin: 40px auto;
            padding: 40px;
            border-radius: 15px;
            max-width: 800px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #2c3e50;
            margin-top: 0;
        }

        .badge {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
            margin-left: 10px;
        }

        .info-box {
            background: rgba(103, 126, 234, 0.1);
            border-left: 4px solid #667eea;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }

        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        ul {
            line-height: 1.8;
        }
    </style>
</head>
<body>
    <!-- Debug panel -->
    <div class="debug-panel" id="debugPanel">
        <h3>üîç Debug Console</h3>
        <div id="debugLog"></div>
    </div>

    <!-- Test tartalom -->
    <div class="test-content">
        <h1>üé® Kezdeti Splat-ok Teszt <span class="badge">3 sz√≠nes folt</span></h1>

        <div class="info-box">
            <strong>‚úÖ Teszt C√©l:</strong><br>
            3 k√ºl√∂nb√∂z≈ë sz√≠n≈± kezdeti folt (t√ºrkiz, lila, kir√°lyk√©k) megjelen√≠t√©se az alap√©rtelmezett piros helyett.
        </div>

        <p><strong>Elv√°rt viselked√©s:</strong></p>
        <ul>
            <li>‚úÖ <strong>3 sz√≠nes folt</strong> jelenik meg inicializ√°l√°skor (300ms k√©sleltet√©ssel)</li>
            <li>‚úÖ <strong>T√ºrkiz</strong> - els≈ë splat (t=0ms)</li>
            <li>‚úÖ <strong>Lila</strong> - m√°sodik splat (t=300ms)</li>
            <li>‚úÖ <strong>Kir√°lyk√©k</strong> - harmadik splat (t=600ms)</li>
            <li>‚ùå <strong>Piros folt NEM jelenik meg</strong></li>
        </ul>

        <p><strong>Teszteld:</strong></p>
        <ul>
            <li>V√°rd meg az oldal bet√∂lt√©s√©t (~1-2 m√°sodperc)</li>
            <li>N√©zd a jobb fels≈ë sarokban a debug konzolt</li>
            <li>Mozgasd az egeret - √∫j sz√≠nes foltok jelennek meg</li>
            <li>F12 ‚Üí Console - r√©szletes logok</li>
        </ul>

        <div class="info-box" style="border-left-color: #FF5722; background: rgba(255, 87, 34, 0.1);">
            <strong>‚ö†Ô∏è Figyelem:</strong><br>
            Ha tov√°bbra is piros folt jelenik meg, akkor a Fluid-JS bels≈ë <code>multipleSplats()</code>
            h√≠v√°sa gyorsabb, mint a mi custom splat-jaink.
        </div>
    </div>

    <!-- Fluid-JS UNAS integr√°ci√≥ k√≥d (TELJES) -->
    <script>
        // Debug logging f√ºggv√©ny
        function debugLog(message, type = 'info') {
            const debugPanel = document.getElementById('debugLog');
            const item = document.createElement('div');
            item.className = `debug-item ${type}`;
            item.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            debugPanel.appendChild(item);

            // Console is
            if (type === 'error') {
                console.error(message);
            } else if (type === 'success') {
                console.log('‚úÖ ' + message);
            } else {
                console.log(message);
            }
        }

        // =============================================================================
        // FLUID-JS UNAS INTEGR√ÅCI√ì - KEZDETI SPLAT-OK TESZTTEL
        // =============================================================================
        (function(){
            debugLog('Script ind√≠t√°sa...', 'info');

            // 1. GLOB√ÅLIS CANVAS L√âTREHOZ√ÅSA
            window.canvas = document.createElement('canvas');
            window.canvas.id = 'renderSurface';
            window.canvas.width = window.innerWidth;
            window.canvas.height = window.innerHeight;
            window.canvas.style.cssText = 'display:block;width:100vw;height:100vh;position:fixed;top:0;left:0;z-index:-1';
            document.body.insertBefore(window.canvas, document.body.firstChild);
            debugLog('Canvas l√©trehozva: ' + window.canvas.width + 'x' + window.canvas.height, 'success');

            // 2. FLUID-JS CDN BET√ñLT√âSE
            var script = document.createElement('script');
            script.src = 'https://cdn.jsdelivr.net/npm/fluid-canvas@latest';
            debugLog('Fluid-JS CDN bet√∂lt√©se...', 'info');

            script.onload = function() {
                debugLog('Fluid-JS CDN bet√∂ltve', 'success');

                // ELS≈ê TIMEOUT: 500ms v√°rakoz√°s
                setTimeout(function() {
                    if (typeof Fluid === 'undefined') {
                        debugLog('Fluid library nem el√©rhet≈ë!', 'error');
                        return;
                    }

                    var canvasElement = document.getElementById('renderSurface');
                    debugLog('Canvas elem lek√©rve: #renderSurface', 'success');

                    try {
                        // 3. FLUID P√âLD√ÅNY L√âTREHOZ√ÅSA
                        var myFluid = new Fluid(canvasElement);
                        debugLog('Fluid p√©ld√°ny l√©trehozva', 'success');

                        // 3.5. FLUID OBJEKTUM INTROSPECTION
                        // N√©zz√ºk meg, milyen met√≥dusok √©rhet≈ëk el
                        debugLog('Fluid objektum met√≥dusainak list√°z√°sa...', 'info');
                        var fluidMethods = [];
                        for (var key in myFluid) {
                            if (typeof myFluid[key] === 'function') {
                                fluidMethods.push(key);
                            }
                        }
                        debugLog('El√©rhet≈ë met√≥dusok: ' + fluidMethods.join(', '), 'info');
                        console.log('üìã Fluid met√≥dusok:', fluidMethods);

                        // Keress√ºk a splat-hoz kapcsol√≥d√≥ met√≥dusokat
                        var splatMethods = fluidMethods.filter(function(m) {
                            return m.toLowerCase().includes('splat');
                        });
                        debugLog('Splat met√≥dusok: ' + (splatMethods.length > 0 ? splatMethods.join(', ') : 'NINCS'), 'info');

                        // ALTERNAT√çV STRAT√âGIA: Canvas tiszt√≠t√°s
                        // Ha nem tudjuk megakad√°lyozni a piros foltot, akkor t√∂r√∂lj√ºk a canvas-t az activate() ut√°n
                        debugLog('Alternat√≠v strat√©gia: Canvas tiszt√≠t√°s 100ms ut√°n...', 'info');

                        // 4. FLUID PARAM√âTEREK BE√ÅLL√çT√ÅSA
                        myFluid.mapBehaviors({
                            sim_resolution: 128,
                            dye_resolution: 512,
                            dissipation: 0.98,
                            velocity: 0.99,
                            pressure: 0.8,
                            pressure_iteration: 20,
                            curl: 30,
                            emitter_size: 0.5,
                            render_shaders: true,
                            multi_color: false,
                            render_bloom: false,
                            background_color: { r: 255, g: 255, b: 255 },
                            transparent: false
                        });
                        debugLog('Fluid param√©terek be√°ll√≠tva', 'success');

                        // M√ÅSODIK TIMEOUT: 300ms v√°rakoz√°s
                        setTimeout(function() {
                            // 5. ANIM√ÅCI√ì AKTIV√ÅL√ÅSA
                            myFluid.activate();
                            debugLog('Fluid aktiv√°lva', 'success');

                            // 5.5. CANVAS TISZT√çT√ÅS (piros folt t√∂rl√©se)
                            // 100ms k√©sleltet√©ssel, hogy a piros folt megjelenjen, azt√°n t√∂r√∂lj√ºk
                            setTimeout(function() {
                                debugLog('Canvas tiszt√≠t√°s - piros folt t√∂rl√©se...', 'info');

                                // WebGL context lek√©r√©se
                                var gl = canvasElement.getContext('webgl') || canvasElement.getContext('experimental-webgl');
                                if (gl) {
                                    // WebGL clear - feh√©r h√°tt√©r
                                    gl.clearColor(1.0, 1.0, 1.0, 1.0);  // Feh√©r (RGBA: 1,1,1,1)
                                    gl.clear(gl.COLOR_BUFFER_BIT);
                                    debugLog('WebGL canvas tiszt√≠tva ‚úÖ', 'success');
                                } else {
                                    debugLog('WebGL context nem el√©rhet≈ë!', 'error');
                                }
                            }, 100);

                            // 6. KEZDETI SPLAT-OK GENER√ÅL√ÅSA (AZONNAL!)
                            var initialColors = [
                                { r: 0, g: 255, b: 255 },           // T√ºrkiz
                                { r: 204, g: 51, b: 255 },          // Lila
                                { r: 0, g: 128, b: 255 }            // Kir√°lyk√©k
                            ];
                            var colorNames = ['T√ºrkiz', 'Lila', 'Kir√°lyk√©k'];

                            debugLog('Kezdeti splat-ok gener√°l√°sa (AZONNALI k√≠s√©rlet)...', 'info');

                            // STRAT√âGIA 1: AZONNALI splat-ok (0ms k√©sleltet√©ssel)
                            // Ez megpr√≥b√°lja "elnyomni" a piros foltot
                            for (var i = 0; i < 3; i++) {
                                (function(index) {
                                    // Nagyobb, l√°tv√°nyosabb splat-ok
                                    var x = (0.3 + Math.random() * 0.4) * window.innerWidth;
                                    var y = (0.3 + Math.random() * 0.4) * window.innerHeight;

                                    // Nagyobb amplit√∫d√≥
                                    var dx = (Math.random() - 0.5) * 2000;  // 2x nagyobb!
                                    var dy = (Math.random() - 0.5) * 2000;

                                    // Sz√≠n be√°ll√≠t√°sa
                                    myFluid.color = initialColors[index];
                                    debugLog(`Splat #${index + 1} (${colorNames[index]}) @ (${Math.round(x)}, ${Math.round(y)}) - AZONNALI`, 'success');

                                    // Szimul√°lt MOUSEDOWN
                                    canvasElement.dispatchEvent(new MouseEvent('mousedown', {
                                        clientX: x,
                                        clientY: y,
                                        bubbles: true
                                    }));

                                    // 100ms k√©sleltet√©s ut√°n MOUSEUP (hosszabb h√∫z√°s)
                                    setTimeout(function() {
                                        canvasElement.dispatchEvent(new MouseEvent('mouseup', {
                                            clientX: x + dx * 0.2,  // 20%-a az amplit√∫d√≥nak (nagyobb mozg√°s)
                                            clientY: y + dy * 0.2,
                                            bubbles: true
                                        }));
                                    }, 100);

                                })(i);  // IIFE - azonnal v√©grehajt√≥dik
                            }

                            // STRAT√âGIA 2: K√©sleltetett "meger≈ës√≠t≈ë" splat-ok (500ms ut√°n)
                            // Ha az AZONNALI splat-ok nem m≈±k√∂dnek, ezek biztosan l√°tszanak
                            setTimeout(function() {
                                debugLog('Meger≈ës√≠t≈ë splat-ok gener√°l√°sa...', 'info');
                                for (var i = 0; i < 3; i++) {
                                    (function(index) {
                                        var x = (0.25 + Math.random() * 0.5) * window.innerWidth;
                                        var y = (0.25 + Math.random() * 0.5) * window.innerHeight;
                                        var dx = (Math.random() - 0.5) * 1500;
                                        var dy = (Math.random() - 0.5) * 1500;

                                        myFluid.color = initialColors[index];
                                        debugLog(`Meger≈ës√≠t≈ë splat #${index + 1} (${colorNames[index]})`, 'info');

                                        canvasElement.dispatchEvent(new MouseEvent('mousedown', {
                                            clientX: x,
                                            clientY: y,
                                            bubbles: true
                                        }));

                                        setTimeout(function() {
                                            canvasElement.dispatchEvent(new MouseEvent('mouseup', {
                                                clientX: x + dx * 0.15,
                                                clientY: y + dy * 0.15,
                                                bubbles: true
                                            }));
                                        }, 75);

                                    })(i);
                                }
                            }, 500);

                            // 7. EG√âRK√ñVET√âS V√ÅLTOZ√ìI
                            var lastX = -1, lastY = -1;
                            var moveCounter = 0;
                            var isSimulating = false;

                            // 8. SZ√çNPALETTA
                            var colors = [
                                { r: 0, g: 255, b: 255 },
                                { r: 204, g: 51, b: 255 },
                                { r: 0, g: 128, b: 255 }
                            ];

                            // 9. EG√âRMOZG√ÅS ESEM√âNYKEZEL≈ê
                            canvasElement.addEventListener('mousemove', function(e) {
                                if (isSimulating || !e.isTrusted) return;

                                var x = e.clientX, y = e.clientY;

                                if (lastX !== -1 && lastY !== -1) {
                                    var dx = x - lastX;
                                    var dy = y - lastY;
                                    var speed = Math.sqrt(dx * dx + dy * dy);

                                    moveCounter++;

                                    if (speed > 3 && moveCounter % 3 === 0) {
                                        isSimulating = true;

                                        myFluid.color = colors[Math.floor(Math.random() * 3)];

                                        canvasElement.dispatchEvent(new MouseEvent('mousedown', {
                                            clientX: x,
                                            clientY: y,
                                            bubbles: true
                                        }));

                                        setTimeout(function() {
                                            canvasElement.dispatchEvent(new MouseEvent('mouseup', {
                                                clientX: x + dx,
                                                clientY: y + dy,
                                                bubbles: true
                                            }));
                                            isSimulating = false;
                                        }, 20);
                                    }
                                }

                                lastX = x;
                                lastY = y;
                            }, {passive: true});

                            debugLog('Eg√©rmozg√°s esem√©nykezel≈ë aktiv√°lva', 'success');
                            debugLog('‚úÖ INICIALIZ√ÅL√ÅS K√âSZ - Mozgasd az egeret!', 'success');

                        }, 300);

                    } catch (error) {
                        debugLog('Hiba: ' + error.message, 'error');
                        console.error('Stack trace:', error.stack);
                    }
                }, 500);
            };

            script.onerror = function() {
                debugLog('Fluid-JS CDN bet√∂lt√©si hiba!', 'error');
            };

            document.head.appendChild(script);
        })();
    </script>
</body>
</html>
